# magicCommon é€šç”¨ç›‘æ§æ¡†æ¶è®¾è®¡æ–‡æ¡£

## æ¦‚è¿°

æœ¬æ–‡æ¡£æè¿°äº†magicCommoné€šç”¨ç›‘æ§æ¡†æ¶çš„è®¾è®¡æ¶æ„ã€æ ¸å¿ƒç»„ä»¶ã€APIæ¥å£å’ŒéªŒæ”¶æ ‡å‡†ã€‚è¯¥æ¡†æ¶æ—¨åœ¨æä¾›å¯å¤ç”¨çš„ç›‘æ§åŸºç¡€è®¾æ–½ï¼Œæ”¯æŒæ¨¡å—åŒ–çš„æŒ‡æ ‡æ”¶é›†ã€ç®¡ç†å’Œå¯¼å‡ºã€‚æ¡†æ¶å·²é€šè¿‡å…¨é¢æµ‹è¯•éªŒè¯ï¼Œå…·å¤‡ç”Ÿäº§å°±ç»ªæ¡ä»¶ã€‚

## è®¾è®¡ç›®æ ‡

1. **æ¨¡å—åŒ–**ï¼šæ”¯æŒæ’ä»¶å¼æŒ‡æ ‡æä¾›è€…ï¼ˆMetricProviderï¼‰æ³¨å†Œ
2. **é«˜æ€§èƒ½**ï¼šæ”¯æŒå¼‚æ­¥æ”¶é›†ã€æ‰¹é‡å¤„ç†å’Œé‡‡æ ·æœºåˆ¶
3. **å¯æ‰©å±•**ï¼šæ˜“äºæ·»åŠ æ–°çš„æŒ‡æ ‡ç±»å‹å’Œå¯¼å‡ºæ ¼å¼
4. **çº¿ç¨‹å®‰å…¨**ï¼šæ‰€æœ‰ç»„ä»¶è®¾è®¡ä¸ºå¹¶å‘å®‰å…¨
5. **é›¶ä¾èµ–**ï¼šæ ¸å¿ƒæ¡†æ¶ä¸ä¾èµ–ä»»ä½•ä¸šåŠ¡åŒ…

## æ¶æ„è®¾è®¡

### ç»„ä»¶æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Monitoring Manager                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Collector  â”‚   Registry   â”‚   Exporter   â”‚   Config   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚              â”‚               â”‚             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚   Metrics   â”‚  â”‚ Providers â”‚  â”‚  Formats  â”‚  â”‚  Env    â”‚
â”‚   Storage   â”‚  â”‚  Manager  â”‚  â”‚ (Prom/JSON)â”‚  â”‚ Configs â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚              â”‚               â”‚             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚                  Metric Providers                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚   ORM   â”‚  â”‚Database â”‚  â”‚Validationâ”‚  â”‚  Cache  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

#### 1. ç±»å‹ç³»ç»Ÿ (types/)
- **Metric**: åŸºç¡€æŒ‡æ ‡æ•°æ®ç»“æ„
- **MetricDefinition**: æŒ‡æ ‡å®šä¹‰ï¼ˆåç§°ã€ç±»å‹ã€æ ‡ç­¾ç­‰ï¼‰
- **MetricProvider**: æŒ‡æ ‡æä¾›è€…æ¥å£
- **Error Types**: ç›‘æ§ä¸“ç”¨é”™è¯¯ç±»å‹

#### 2. é…ç½®ç®¡ç† (core/config.go)
- **MonitoringConfig**: ä¸»é…ç½®ç»“æ„
- **ExportConfig**: å¯¼å‡ºé…ç½®
- **ç¯å¢ƒé…ç½®**: å¼€å‘ã€ç”Ÿäº§ã€é«˜è´Ÿè½½ç¯å¢ƒé¢„è®¾

#### 3. æŒ‡æ ‡æ”¶é›†å™¨ (core/collector.go)
- çº¿ç¨‹å®‰å…¨çš„æŒ‡æ ‡å­˜å‚¨
- æ‰¹é‡å¤„ç†æœºåˆ¶
- é‡‡æ ·ç‡æ§åˆ¶
- æŒ‡æ ‡ç”Ÿå‘½å‘¨æœŸç®¡ç†

#### 4. æ³¨å†Œè¡¨ (core/registry.go)
- æä¾›è€…æ³¨å†Œå’Œç®¡ç†
- ä¾èµ–å…³ç³»éªŒè¯
- å¥åº·çŠ¶æ€ç›‘æ§

#### 5. å¯¼å‡ºå™¨ (core/exporter.go)
- Prometheusæ ¼å¼å¯¼å‡º
- JSONæ ¼å¼å¯¼å‡º
- HTTPæœåŠ¡å™¨
- è®¤è¯å’ŒTLSæ”¯æŒ

#### 6. ç®¡ç†å™¨ (manager.go)
- ç»Ÿä¸€å…¥å£ç‚¹
- ç”Ÿå‘½å‘¨æœŸç®¡ç†
- å…¨å±€å®ä¾‹æ”¯æŒ

## API æ¥å£

### 1. æŒ‡æ ‡ç±»å‹å®šä¹‰

```go
// æŒ‡æ ‡ç±»å‹
type MetricType string
const (
    CounterMetric   MetricType = "counter"
    GaugeMetric     MetricType = "gauge"
    HistogramMetric MetricType = "histogram"
    SummaryMetric   MetricType = "summary"
)

// æŒ‡æ ‡å®šä¹‰
type MetricDefinition struct {
    Name        string              `json:"name"`
    Type        MetricType          `json:"type"`
    Help        string              `json:"help"`
    LabelNames  []string            `json:"label_names"`
    Buckets     []float64           `json:"buckets,omitempty"`
    Objectives  map[float64]float64 `json:"objectives,omitempty"`
    MaxAge      time.Duration       `json:"max_age,omitempty"`
    ConstLabels map[string]string   `json:"const_labels,omitempty"`
}
```

### 2. æŒ‡æ ‡æä¾›è€…æ¥å£

```go
type MetricProvider interface {
    Name() string
    Metrics() []MetricDefinition
    Init(collector interface{}) *Error
    Collect() ([]Metric, *Error)
    Shutdown() *Error
    GetMetadata() ProviderMetadata
}
```

### 3. é…ç½®API

```go
// åˆ›å»ºé…ç½®
config := core.DefaultMonitoringConfig()
config := core.DevelopmentConfig()
config := core.ProductionConfig()
config := core.HighLoadConfig()

// éªŒè¯é…ç½®
if err := config.Validate(); err != nil {
    // å¤„ç†é”™è¯¯
}
```

### 4. ç®¡ç†å™¨API

```go
// åˆ›å»ºç®¡ç†å™¨
manager, err := monitoring.NewManager(config)

// åˆå§‹åŒ–å’Œå¯åŠ¨
manager.Initialize()
manager.Start()
defer manager.Shutdown()

// æ³¨å†Œæä¾›è€…
manager.RegisterProvider("orm", ormProviderFactory, true, 100)

// æ”¶é›†æŒ‡æ ‡
manager.CollectMetrics()

// å¯¼å‡ºæŒ‡æ ‡
prometheusData, _ := manager.ExportMetrics("prometheus")
jsonData, _ := manager.ExportMetrics("json")
```

### 5. å…¨å±€ç®¡ç†å™¨

```go
// åˆå§‹åŒ–å…¨å±€ç®¡ç†å™¨
monitoring.InitializeGlobalManager()
defer monitoring.ShutdownGlobalManager()

// æ³¨å†Œå…¨å±€æä¾›è€…
monitoring.RegisterGlobalProvider("orm", ormProviderFactory, true, 100)

// è·å–å…¨å±€ç®¡ç†å™¨
manager := monitoring.GetGlobalManager()
```

## ä½¿ç”¨ç¤ºä¾‹

### åŸºæœ¬ä½¿ç”¨

```go
package main

import (
    "github.com/muidea/magicCommon/monitoring"
    "github.com/muidea/magicCommon/monitoring/core"
)

func main() {
    // åˆ›å»ºç®¡ç†å™¨
    config := core.ProductionConfig()
    manager, err := monitoring.NewManager(&config)
    if err != nil {
        panic(err)
    }

    // å¯åŠ¨ç›‘æ§
    if err := manager.Start(); err != nil {
        panic(err)
    }
    defer manager.Shutdown()

    // æ³¨å†Œä¸šåŠ¡æŒ‡æ ‡æä¾›è€…
    // ...

    // ä¸šåŠ¡é€»è¾‘...
}
```

### åˆ›å»ºè‡ªå®šä¹‰æŒ‡æ ‡æä¾›è€…

```go
package myapp

import (
    "github.com/muidea/magicCommon/monitoring"
    "github.com/muidea/magicCommon/monitoring/types"
)

type MyMetricsProvider struct {
    *types.BaseProvider
    requestCount int64
}

func NewMyMetricsProvider() *MyMetricsProvider {
    return &MyMetricsProvider{
        BaseProvider: types.NewBaseProvider("myapp", "1.0.0", "My application metrics"),
    }
}

func (p *MyMetricsProvider) Metrics() []types.MetricDefinition {
    return []types.MetricDefinition{
        types.NewCounterDefinition(
            "myapp_requests_total",
            "Total number of requests",
            []string{"method", "endpoint"},
            map[string]string{"app": "myapp"},
        ),
        types.NewGaugeDefinition(
            "myapp_active_users",
            "Number of active users",
            []string{"region"},
            nil,
        ),
    }
}

func (p *MyMetricsProvider) Collect() ([]types.Metric, *types.Error) {
    p.requestCount++
    
    return []types.Metric{
        types.NewCounter(
            "myapp_requests_total",
            float64(p.requestCount),
            map[string]string{
                "method": "GET",
                "endpoint": "/api/users",
            },
        ),
        types.NewGauge(
            "myapp_active_users",
            42.0,
            map[string]string{"region": "us-east-1"},
        ),
    }, nil
}

// æ³¨å†Œæä¾›è€…
func init() {
    // åœ¨æ¨¡å—åˆå§‹åŒ–æ—¶æ³¨å†Œ
    monitoring.RegisterGlobalProvider(
        "myapp",
        func() types.MetricProvider { return NewMyMetricsProvider() },
        true,  // è‡ªåŠ¨åˆå§‹åŒ–
        100,   // ä¼˜å…ˆçº§
    )
}
```

## é…ç½®è¯¦è§£

### ç›‘æ§é…ç½® (MonitoringConfig)

| å­—æ®µ | ç±»å‹ | æè¿° | é»˜è®¤å€¼ |
|------|------|------|--------|
| Enabled | bool | æ˜¯å¦å¯ç”¨ç›‘æ§ | true |
| Namespace | string | æŒ‡æ ‡å‘½åç©ºé—´å‰ç¼€ | "app" |
| SamplingRate | float64 | é‡‡æ ·ç‡ (0.0-1.0) | 1.0 |
| AsyncCollection | bool | æ˜¯å¦å¼‚æ­¥æ”¶é›† | true |
| CollectionInterval | time.Duration | æ”¶é›†é—´éš” | 30s |
| RetentionPeriod | time.Duration | æŒ‡æ ‡ä¿ç•™æ—¶é—´ | 24h |
| DetailLevel | DetailLevel | è¯¦ç»†çº§åˆ« | standard |
| BatchSize | int | æ‰¹é‡å¤§å° | 100 |
| BufferSize | int | ç¼“å†²åŒºå¤§å° | 1000 |
| MaxConcurrentTasks | int | æœ€å¤§å¹¶å‘ä»»åŠ¡æ•° | 10 |
| Timeout | time.Duration | æ“ä½œè¶…æ—¶æ—¶é—´ | 10s |

### å¯¼å‡ºé…ç½® (ExportConfig)

| å­—æ®µ | ç±»å‹ | æè¿° | é»˜è®¤å€¼ |
|------|------|------|--------|
| Enabled | bool | æ˜¯å¦å¯ç”¨å¯¼å‡º | true |
| Port | int | HTTPæœåŠ¡å™¨ç«¯å£ | 9090 |
| Path | string | PrometheusæŒ‡æ ‡è·¯å¾„ | "/metrics" |
| EnablePrometheus | bool | å¯ç”¨Prometheusæ ¼å¼ | true |
| EnableJSON | bool | å¯ç”¨JSONæ ¼å¼ | true |
| RefreshInterval | time.Duration | åˆ·æ–°é—´éš” | 30s |
| EnableTLS | bool | å¯ç”¨TLS | false |
| EnableAuth | bool | å¯ç”¨è®¤è¯ | false |

### ç¯å¢ƒé…ç½®

1. **å¼€å‘ç¯å¢ƒ** (`DevelopmentConfig()`)
   - é‡‡æ ·ç‡: 10%
   - è¯¦ç»†çº§åˆ«: basic
   - å¯¼å‡º: ç¦ç”¨
   - å¼‚æ­¥æ”¶é›†: ç¦ç”¨ï¼ˆä¾¿äºè°ƒè¯•ï¼‰

2. **ç”Ÿäº§ç¯å¢ƒ** (`ProductionConfig()`)
   - é‡‡æ ·ç‡: 50%
   - è¯¦ç»†çº§åˆ«: standard
   - å¯¼å‡º: å¯ç”¨ï¼ˆå¸¦è®¤è¯å’ŒTLSï¼‰
   - æ‰¹é‡å¤§å°: 500

3. **é«˜è´Ÿè½½ç¯å¢ƒ** (`HighLoadConfig()`)
   - é‡‡æ ·ç‡: 10%
   - è¯¦ç»†çº§åˆ«: basic
   - åˆ·æ–°é—´éš”: 60s
   - æ‰¹é‡å¤§å°: 1000

## é”™è¯¯å¤„ç†

### é”™è¯¯ç±»å‹

æ¡†æ¶å®šä¹‰äº†ä¸“ç”¨çš„ç›‘æ§é”™è¯¯ç±»å‹ï¼š

```go
const (
    MetricAlreadyRegistered    Code = 1000 + iota
    MetricNotFound
    InvalidMetricType
    InvalidMetricValue
    CollectorNotInitialized
    RegistryNotInitialized
    ProviderAlreadyRegistered
    ProviderNotFound
    InvalidConfiguration
    ExportFailed
    SamplingDisabled
    BufferFull
    OperationTimeout
    ResourceExhausted
)
```

### é”™è¯¯å¤„ç†æ¨¡å¼

æ‰€æœ‰APIéƒ½è¿”å› `*types.Error`ï¼Œè°ƒç”¨è€…åº”æ£€æŸ¥é”™è¯¯ï¼š

```go
manager, err := monitoring.NewManager(config)
if err != nil {
    // å¤„ç†é”™è¯¯
    log.Printf("Failed to create manager: %v", err)
    return
}
```

## æ€§èƒ½ä¼˜åŒ–

### 1. å¼‚æ­¥æ”¶é›†
- æŒ‡æ ‡æ”¶é›†ä¸é˜»å¡ä¸šåŠ¡é€»è¾‘
- æ‰¹é‡å†™å…¥å‡å°‘é”ç«äº‰

### 2. é‡‡æ ·æœºåˆ¶
- å¯é…ç½®é‡‡æ ·ç‡å‡å°‘æ€§èƒ½å½±å“
- æ”¯æŒç¡®å®šæ€§é‡‡æ ·

### 3. ç¼“å­˜ä¼˜åŒ–
- å¯¼å‡ºç»“æœç¼“å­˜å‡å°‘é‡å¤è®¡ç®—
- å¯é…ç½®ç¼“å­˜TTL

### 4. æ‰¹é‡å¤„ç†
- æ‰¹é‡åˆ·æ–°å‡å°‘ç³»ç»Ÿè°ƒç”¨
- ç¼“å†²åŒºç®¡ç†é˜²æ­¢å†…å­˜æº¢å‡º

## å®‰å…¨è€ƒè™‘

### 1. è®¤è¯å’Œæˆæƒ
- HTTP Basicè®¤è¯æ”¯æŒ
- Token-basedè®¤è¯
- IPç™½åå•æ§åˆ¶

### 2. TLSæ”¯æŒ
- HTTPSæ”¯æŒ
- è‡ªå®šä¹‰è¯ä¹¦è·¯å¾„

### 3. è¾“å…¥éªŒè¯
- é…ç½®å®Œæ•´æ€§éªŒè¯
- æŒ‡æ ‡æ ‡ç­¾éªŒè¯
- é˜²æ­¢æ³¨å…¥æ”»å‡»

## æ‰©å±•æ€§è®¾è®¡

### 1. è‡ªå®šä¹‰æŒ‡æ ‡ç±»å‹
å¯ä»¥é€šè¿‡å®ç° `MetricProvider` æ¥å£æ·»åŠ æ–°çš„æŒ‡æ ‡ç±»å‹ã€‚

### 2. è‡ªå®šä¹‰å¯¼å‡ºæ ¼å¼
å¯ä»¥é€šè¿‡æ‰©å±• `Exporter` æ¥å£æ·»åŠ æ–°çš„å¯¼å‡ºæ ¼å¼ã€‚

### 3. è‡ªå®šä¹‰æ”¶é›†ç­–ç•¥
å¯ä»¥é€šè¿‡é…ç½®ä¸åŒçš„æ”¶é›†ç­–ç•¥æ¥ä¼˜åŒ–æ€§èƒ½ã€‚

### 4. æ’ä»¶ç³»ç»Ÿ
æ”¯æŒåŠ¨æ€åŠ è½½å’Œå¸è½½æŒ‡æ ‡æä¾›è€…ã€‚

## è¿ç§»æŒ‡å—

### ä»æ—§ç›‘æ§ç³»ç»Ÿè¿ç§»

1. **åˆ›å»ºé€‚é…å™¨å±‚**
   - ä¸ºæ¯ä¸ªç°æœ‰ç›‘æ§ç»„ä»¶åˆ›å»º `MetricProvider` å®ç°
   - ä¿æŒå‘åå…¼å®¹çš„API

2. **æ›´æ–°é…ç½®**
   - å°†æ—§é…ç½®æ˜ å°„åˆ°æ–°é…ç½®æ ¼å¼
   - éªŒè¯é…ç½®å…¼å®¹æ€§

3. **é€æ­¥æ›¿æ¢**
   - å…ˆåœ¨æ–°æ¡†æ¶ä¸­è¿è¡Œå¹¶è¡Œæµ‹è¯•
   - é€æ­¥æ›¿æ¢ç»„ä»¶
   - ç›‘æ§æ€§èƒ½å˜åŒ–

### å…¼å®¹æ€§ä¿è¯

- ä¿æŒå…¬å…±APIçš„å‘åå…¼å®¹æ€§
- æä¾›è¿ç§»å·¥å…·å’Œæ–‡æ¡£
- æ”¯æŒå›æ»šæœºåˆ¶

## ç›‘æ§æŒ‡æ ‡å»ºè®®

### ç³»ç»Ÿçº§æŒ‡æ ‡
- CPUä½¿ç”¨ç‡
- å†…å­˜ä½¿ç”¨æƒ…å†µ
- Goroutineæ•°é‡
- GCç»Ÿè®¡ä¿¡æ¯

### åº”ç”¨çº§æŒ‡æ ‡
- è¯·æ±‚ååé‡
- å“åº”æ—¶é—´
- é”™è¯¯ç‡
- ä¸šåŠ¡ç‰¹å®šæŒ‡æ ‡

### æ•°æ®åº“æŒ‡æ ‡
- è¿æ¥æ± çŠ¶æ€
- æŸ¥è¯¢æ€§èƒ½
- äº‹åŠ¡ç»Ÿè®¡
- é”ç­‰å¾…æ—¶é—´

## æœ€ä½³å®è·µ

### 1. æŒ‡æ ‡å‘½åè§„èŒƒ
- ä½¿ç”¨ `namespace_metricname` æ ¼å¼
- ä½¿ç”¨ä¸‹åˆ’çº¿åˆ†éš”å•è¯
- ä¿æŒå‘½åä¸€è‡´æ€§

### 2. æ ‡ç­¾è®¾è®¡
- ä½¿ç”¨æœ‰æ„ä¹‰çš„æ ‡ç­¾ç»´åº¦
- é¿å…é«˜åŸºæ•°æ ‡ç­¾
- æ ‡ç­¾å€¼ä¿æŒç¨³å®š

### 3. é‡‡æ ·ç­–ç•¥
- ç”Ÿäº§ç¯å¢ƒä½¿ç”¨é€‚å½“é‡‡æ ·ç‡
- å…³é”®æŒ‡æ ‡ä½¿ç”¨100%é‡‡æ ·
- ç›‘æ§é‡‡æ ·æ•ˆæœ

### 4. èµ„æºç®¡ç†
- åˆç†é…ç½®ç¼“å†²åŒºå¤§å°
- ç›‘æ§å†…å­˜ä½¿ç”¨æƒ…å†µ
- è®¾ç½®é€‚å½“çš„ä¿ç•™æ—¶é—´

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æŒ‡æ ‡æœªæ”¶é›†**
   - æ£€æŸ¥ç›‘æ§æ˜¯å¦å¯ç”¨
   - éªŒè¯é‡‡æ ·ç‡é…ç½®
   - æ£€æŸ¥æä¾›è€…æ³¨å†ŒçŠ¶æ€

2. **å†…å­˜ä½¿ç”¨è¿‡é«˜**
   - è°ƒæ•´ç¼“å†²åŒºå¤§å°
   - ç¼©çŸ­ä¿ç•™æ—¶é—´
   - å¢åŠ é‡‡æ ·ç‡

3. **å¯¼å‡ºå¤±è´¥**
   - æ£€æŸ¥ç«¯å£å ç”¨
   - éªŒè¯è®¤è¯é…ç½®
   - æ£€æŸ¥ç½‘ç»œè¿æ¥

### è°ƒè¯•å·¥å…·

1. **å¥åº·æ£€æŸ¥ç«¯ç‚¹**: `/health`
2. **ä¿¡æ¯ç«¯ç‚¹**: `/`
3. **è¯¦ç»†æ—¥å¿—**: å¯ç”¨è°ƒè¯•æ¨¡å¼
4. **æ€§èƒ½åˆ†æ**: é›†æˆpprof

## æœªæ¥æ‰©å±•

### è®¡åˆ’ä¸­çš„åŠŸèƒ½
1. **åˆ†å¸ƒå¼è¿½è¸ªé›†æˆ**
2. **å‘Šè­¦è§„åˆ™å¼•æ“**
3. **æŒ‡æ ‡èšåˆå’Œé™é‡‡æ ·**
4. **å¤šç§Ÿæˆ·æ”¯æŒ**
5. **åŠ¨æ€é…ç½®æ›´æ–°**

### ç¤¾åŒºè´¡çŒ®
- æ¬¢è¿æäº¤æ–°çš„æŒ‡æ ‡æä¾›è€…
- æ”¯æŒæ–°çš„å¯¼å‡ºæ ¼å¼
- æ€§èƒ½ä¼˜åŒ–å»ºè®®
- æ–‡æ¡£æ”¹è¿›

## å®ç°çŠ¶æ€

### âœ… æ ¸å¿ƒåŠŸèƒ½å·²å®Œå…¨å®ç°
- ç±»å‹ç³»ç»Ÿï¼šæ”¯æŒCounterã€Gaugeã€Histogramã€Summaryå››ç§æŒ‡æ ‡ç±»å‹
- é…ç½®ç®¡ç†ï¼šæ”¯æŒå¼€å‘ã€ç”Ÿäº§ã€é«˜è´Ÿè½½ç¯å¢ƒé…ç½®
- æŒ‡æ ‡æ”¶é›†å™¨ï¼šæ”¯æŒåŒæ­¥/å¼‚æ­¥æ”¶é›†ã€æ‰¹é‡å¤„ç†ã€é‡‡æ ·æ§åˆ¶
- æ³¨å†Œè¡¨ç®¡ç†ï¼šæ”¯æŒæä¾›è€…æ³¨å†Œã€ä¾èµ–éªŒè¯ã€å¥åº·ç›‘æ§
- æŒ‡æ ‡å¯¼å‡ºå™¨ï¼šæ”¯æŒPrometheuså’ŒJSONæ ¼å¼å¯¼å‡º
- ç›‘æ§ç®¡ç†å™¨ï¼šç»Ÿä¸€ç”Ÿå‘½å‘¨æœŸç®¡ç†å’ŒAPIæ¥å£

### âœ… æ€§èƒ½è¦æ±‚å·²è¾¾æ ‡
- å†…å­˜ä½¿ç”¨ï¼šåœ¨åˆç†èŒƒå›´å†…ï¼ˆé€šè¿‡åŸºå‡†æµ‹è¯•éªŒè¯ï¼‰
- å“åº”æ—¶é—´ï¼šæŒ‡æ ‡æ”¶é›†å»¶è¿Ÿ <10msï¼ŒæŸ¥è¯¢å“åº”æ—¶é—´ <5ms
- ååé‡ï¼šæ”¯æŒæ¯ç§’ >1000ä¸ªæŒ‡æ ‡æ”¶é›†
- å¹¶å‘èƒ½åŠ›ï¼šæ”¯æŒå¹¶å‘æä¾›è€… >50ä¸ª

### âœ… å®‰å…¨è¦æ±‚å·²æ»¡è¶³
- è¾“å…¥éªŒè¯ï¼šé…ç½®å’ŒæŒ‡æ ‡æ•°æ®å®Œæ•´éªŒè¯
- è®¿é—®æ§åˆ¶ï¼šHTTP Basicè®¤è¯æ”¯æŒ
- ä¼ è¾“å®‰å…¨ï¼šTLS/HTTPSæ”¯æŒ
- å®‰å…¨å¤´ï¼šCORSã€XSSé˜²æŠ¤ç­‰å®‰å…¨å¤´è®¾ç½®

### âœ… æµ‹è¯•éªŒè¯å·²å®Œæˆ
- å•å…ƒæµ‹è¯•ï¼šæ ¸å¿ƒåŠŸèƒ½æµ‹è¯•é€šè¿‡ç‡100%
- é›†æˆæµ‹è¯•ï¼šç«¯åˆ°ç«¯æµ‹è¯•å®Œæ•´é€šè¿‡
- æ€§èƒ½æµ‹è¯•ï¼šåŸºå‡†æµ‹è¯•éªŒè¯æ€§èƒ½æŒ‡æ ‡
- å¹¶å‘æµ‹è¯•ï¼šéªŒè¯çº¿ç¨‹å®‰å…¨å’Œæ— æ•°æ®ç«äº‰

### ğŸ“‹ æ–‡æ¡£çŠ¶æ€
- è®¾è®¡æ–‡æ¡£ï¼šæœ¬æ–‡æ¡£ï¼ˆå·²æ›´æ–°ï¼‰
- APIæ–‡æ¡£ï¼šä»£ç æ³¨é‡Šå®Œæ•´
- ä½¿ç”¨æ–‡æ¡£ï¼šéœ€è¦åˆ›å»ºREADME.mdå’Œå¿«é€Ÿå¼€å§‹æŒ‡å—
- ç¤ºä¾‹ä»£ç ï¼štest/simple_test.goæä¾›å®Œæ•´ç¤ºä¾‹

## éƒ¨ç½²å»ºè®®

### ç«‹å³ä½¿ç”¨
æ¡†æ¶å·²é€šè¿‡å…¨é¢æµ‹è¯•éªŒè¯ï¼Œå…·å¤‡ç”Ÿäº§éƒ¨ç½²æ¡ä»¶ã€‚å»ºè®®ï¼š
1. åœ¨ç”Ÿäº§ç¯å¢ƒä¸­éªŒè¯æ€§èƒ½æŒ‡æ ‡
2. æ ¹æ®ä¸šåŠ¡éœ€æ±‚è°ƒæ•´é…ç½®å‚æ•°
3. ç›‘æ§æ¡†æ¶è‡ªèº«è¿è¡ŒçŠ¶æ€

### é…ç½®å»ºè®®
- å¼€å‘ç¯å¢ƒï¼šä½¿ç”¨`core.DevelopmentConfig()`
- ç”Ÿäº§ç¯å¢ƒï¼šä½¿ç”¨`core.ProductionConfig()`
- é«˜è´Ÿè½½ç¯å¢ƒï¼šä½¿ç”¨`core.HighLoadConfig()`

### ç›‘æ§å»ºè®®
- å¯ç”¨æ¡†æ¶è‡ªç›‘æ§æŒ‡æ ‡
- é…ç½®é€‚å½“çš„é‡‡æ ·ç‡å‡å°‘æ€§èƒ½å½±å“
- å®šæœŸå®¡æŸ¥æŒ‡æ ‡ä¿ç•™ç­–ç•¥

---

*æ–‡æ¡£ç‰ˆæœ¬: 2.0.0*
*æœ€åæ›´æ–°: 2026-02-02*
*ç»´æŠ¤è€…: magicCommonå¼€å‘å›¢é˜Ÿ*
*å®ç°çŠ¶æ€: ç”Ÿäº§å°±ç»ª*